[
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html",
    "title": "Peptide Classification with Machine Learning",
    "section": "",
    "text": "Protein–protein interactions (PPIs) are central to almost every biological process, yet their complexity often makes them difficult to describe and predict. Traditional models emphasize short-range atomic contacts or electrostatic complementarity, but these approaches can fail to capture the broader physicochemical principles that govern biomolecular recognition.\nIn the paper “Deciphering peptide–protein interactions via composition-based prediction: a case study with survivin/BIRC5” (Anindya et al., 2024), a different approach was introduced. Instead of focusing on the detailed three-dimensional structures of proteins, the study analyzed their composition (the number and types of atoms or functional groups within peptides) and used this as a predictive descriptor of interaction with the human protein survivin (BIRC5)\nThe goal of this practical is to build a classifier that predicts peptide binding signal from microarray data using encoded features derived from amino-acid properties. You will first perform a basic run-through of the provided notebook, then complete a set of ML-focused tasks.\nUse the annotated notebook aa_scan2_clean_annotated.ipynb for the exercise, it will serve as the hand in for this segment.\n\n\n\n\n\n\nCreate a working directory\n\n\n\n# Create a new folder for this practical\nmkdir -p ~/BIO512/Peptide_Classification\n\n# Fetch the required files from Vera\n# do note that &lt;__&gt; is a placeholder for your vera username\nscp -r &lt;your_vera_username&gt;@vera2.chalmers.se:/cephyr/NOBACKUP/groups/n2bin_gu/BIO512/practicals/Peptide_Classification/* ~/BIO512/Peptide_Classification/\n\nNotebook: aa_scan2_clean_annotated.ipynb\nProperty table: aa_properties.xlsx (1,2 and 3 for each encoding)\nMicroarray data: Clean_results_2_2019.xlsx\n\n\nOpen the notebook in VS Code or Jupyter from your working directory\nEnsure packages are available: pandas, numpy, seaborn, scikit-learn, matplotlib.\n\n\n\n\n\n\n\n\n\nLearning Objectives\n\n\n\nBy the end you should be able to:\n\nExplain how compositional features can represent molecular information.\nImplement a simple neural network for binary classification in Python.\nInterpret model performance using standard metrics.\nDiscuss the implications of composition-based models for molecular biology and drug discovery"
  },
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#data-inspection-and-preparation",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#data-inspection-and-preparation",
    "title": "Peptide Classification with Machine Learning",
    "section": "2.1 1. Data inspection and preparation",
    "text": "2.1 1. Data inspection and preparation\n\nImport core libraries. If an import fails, install and re-run.\n\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pylab as plt\nimport numpy as np\n\nLoad aa_properties.xlsx and confirm it contains the AA letter column (e.g., aa) and feature columns. The different numbers (1, 2, 3) correspond to different aa representation schemes.\n\n\n\n\n\n\n\nNote\n\n\n\nThe dataset originates from a peptide microarray experiment containing peptides from 36 known or potential survivin interaction partners. Each peptide is 15 amino acids long, with overlapping sequences, and is labeled as binder or non-binder based on fluorescence intensity measurements.\n\n\n\nLoad the microarray dataset (Clean_results_2_2019.xlsx)\n\n\n\n\n\n\n\nQ1\n\n\n\nLook at the distribution of binding and non-binding peptides. How many binders are there? How many non-binders?"
  },
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#feature-encoding",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#feature-encoding",
    "title": "Peptide Classification with Machine Learning",
    "section": "2.2 2. Feature encoding",
    "text": "2.2 2. Feature encoding\n\nRepresent peptides by counting atomic or functional group.\n\nMake sure to check output data from all the matrix transformations so that they make sense.\n\nOptionally, compare the peptide encodings with the amino acid sequence representations."
  },
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#model-training",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#model-training",
    "title": "Peptide Classification with Machine Learning",
    "section": "2.3 3. Model training",
    "text": "2.3 3. Model training\nThe main engine block of the notebook has multiple configurations of various classifiers prepared. These classifiers all come as part of the scikit-learn library. To use a different classifier, simply uncomment the relevant line and comment out the rest.\n\nBegin by building a multilayer perceptron (MLP) classifier using the MLPClassifier from scikit-learn.\nSplit the data into training and test sets for model evaluation. If you’re interested there are also more advanced methods such as cross-validation\n\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.gaussian_process import GaussianProcessClassifier\nfrom sklearn.gaussian_process.kernels import RBF\nfrom sklearn import datasets, svm, metrics\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler\n#clf = svm.SVC(gamma=0.001)\n#clf = RandomForestClassifier(max_depth=None, n_estimators=100, max_features='auto')\n#clf = MLPClassifier(solver='lbfgs',random_state=1, max_iter=10000)\nclf = MLPClassifier(hidden_layer_sizes=(2,), random_state=1, max_iter=10000)\n#clf = GaussianProcessClassifier(1.0 * RBF(1.0))\n#clf = DecisionTreeClassifier(max_depth=5)\n#clf = KNeighborsClassifier(5)\n#clf = AdaBoostClassifier()\n\nfeature_names=[u'CA-Gly', u'Pro-MC', u'CB', u'CB-Pro',\n        u'Carboxyl', u'Amide',\n        u'His', u'Trp', u'Phe-Tyr', u'OH-Tyr', u'CG', u'CD', u'CE',\n        u'OH', u'SH', u'S', u'NH3', u'Arg',u'MC']\nX = np.array(mergepf[feature_names])\n\n# Other array setups #\n\nY=np.array(mergepf[u'Fluorescence']&gt;0)\n\n# Other array setups #\n\nsc=StandardScaler()\n\nX_train, X_test, y_train, y_test = train_test_split(\n    X, Y, test_size=0.5, shuffle=True)\n\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)\n\nclf.fit(X_train, y_train)\npredict=clf.predict(X_test)\npredict"
  },
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#model-evaluation",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#model-evaluation",
    "title": "Peptide Classification with Machine Learning",
    "section": "2.4 4. Model evaluation",
    "text": "2.4 4. Model evaluation\n\nCompute accuracy, precision, recall, and F1 scores.\n\n\n\n\n\n\n\nQ2\n\n\n\nWhat are the accuracy, precision, recall, and F1 scores of your MLP? How do these metrics reflect the model’s performance?\n\n\n\nRerun the above section using different encodings.\n\n\n\n\n\n\n\nQ3\n\n\n\nHow do the different encodings affect the model’s performance? Which encoding yields the best results?"
  },
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#visualizing-results",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#visualizing-results",
    "title": "Peptide Classification with Machine Learning",
    "section": "2.5 5. Visualizing results",
    "text": "2.5 5. Visualizing results\n\nInspect the trained weights on the neural network\n\n\n\n\n\n\n\nQ4\n\n\n\nDiscuss briefly (1-2 sentences) which peptide compositions are most likely to be classified as survivin binders, and explain how the prediction is determined from the input features, hidden layers, and connection weights of the neural network."
  },
  {
    "objectID": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#interpretation-and-discussion",
    "href": "practicals/PRACTICALS-Peptide_Classification/PRACTICAL_PEPTIDE_CLASSIFICATION_ML.html#interpretation-and-discussion",
    "title": "Peptide Classification with Machine Learning",
    "section": "2.6 6. Interpretation and discussion",
    "text": "2.6 6. Interpretation and discussion\n\nExamine feature importance and identify which functional groups most influence binding prediction.\n\n\n\n\n\n\n\nQ5\n\n\n\nDiscuss the implications of your findings. How do the identified features align with known biological principles of peptide binding? What could be the significance to survivin binding in a biological context?\n\n\n\n\n\n\n\n\nDiscussion\n\n\n\nAnswer the following questions with short reflections (2-3 sentences each):\n\nWhy might compositional information alone provide predictive power for peptide binding?\nHow do simple models sometimes outperform complex sequence-based neural networks?\nWhat are the potential advantages and limitations of composition-based approaches in structural biology and drug design?"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html",
    "title": "Molecular Dynamics Simulation Analysis",
    "section": "",
    "text": "In this practical, we will analyze the results of molecular dynamics (MD) simulations to understand the impact of molecular glue on protein complex stability. Two separate MD simulations have been conducted (~30 ns each): one with the molecular glue (rapamycin) and one without it. MD simulations can reveal how the molecular glue affects the dynamic behavior and stability of the protein complex over time."
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#running-the-analysis",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#running-the-analysis",
    "title": "Molecular Dynamics Simulation Analysis",
    "section": "2.1 Running the analysis",
    "text": "2.1 Running the analysis\n\n\n\n\n\n\nNote\n\n\n\nThese simulations take a long time to run, so we have pre-computed the trajectories for you. Your task is to analyze these trajectories to extract meaningful insights about the effect of the molecular glue.\n\n\nSet the working directory:\n\nOpen YASARA\nSet the working directory to your copied MD folder (if you want to be extra specific ./MD/with_glue)\n\nSet the target:\n\nOptions &gt; Macro & Movies &gt; Set target &gt; 3FAP_complex.sce\n\n\n\n\n\n\n\nTip\n\n\n\nYou might need to swap back to file extension instead of “from underscore” when setting the target.\n\n\nExecute MD analysis:\n\nOptions &gt; Macro & Movies &gt; play macro &gt; md_analyze.mcr &gt; OK\n\n\n\n\n\n\n\nAnalysis time\n\n\n\nThis analysis takes some time to complete. The macro will process the entire trajectory and calculate various structural parameters."
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#interpreting-the-results",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#interpreting-the-results",
    "title": "Molecular Dynamics Simulation Analysis",
    "section": "2.2 Interpreting the results",
    "text": "2.2 Interpreting the results\nAfter Analysis is done, the results will be shown in an “html” file where you can see all different analysis metric with explanations for each. For this tutorial, the most important metric is “Solute RMSD from the starting structure” focused on proteins backbone (RMSDBb) which indicates the protein’s conformational deviation compared to the initial structure by time. The raw data of the plots are available in the file named “3FAP_complex_analysis.tab”\nReview the HTML report:\n\nAfter analysis is complete, results will be shown in an HTML file\nThe report contains different analysis metrics with explanations\nFocus on “Solute RMSD from the starting structure” for protein backbone (RMSDBb)"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#extracting-data",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#extracting-data",
    "title": "Molecular Dynamics Simulation Analysis",
    "section": "3.1 Extracting data",
    "text": "3.1 Extracting data\nDownload the analysis file:\n\nDownload 3FAP_complex_analysis.tab to your local computer (ex. zip it and scp or similar)\n\nOpen in spreadsheet software:\n\nOpen the file using MS Excel or similar software\nLocate the RMSDBb column and time column\n\nCalculate average RMSD:\n\nCalculate the average RMSD over the second half of the simulation (t &gt; 15ns)\nThis represents the equilibrated state of the system\nRecord this value for comparison"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#repeat-analysis-for-control-system",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#repeat-analysis-for-control-system",
    "title": "Molecular Dynamics Simulation Analysis",
    "section": "4.1 Repeat analysis for control system",
    "text": "4.1 Repeat analysis for control system\nSet new working directory:\n\nChange working directory to MD/without_glue\n\nRepeat steps 2-9:\n\nSet target to the complex without glue\nRun md_analyze.mcr\nDownload and process the analysis results\nPlot RMSD vs time\nCalculate average RMSD for t &gt; 15ns"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#generating-comparison-plots",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MD_ANALYSIS.html#generating-comparison-plots",
    "title": "Molecular Dynamics Simulation Analysis",
    "section": "5.1 Generating comparison plots",
    "text": "5.1 Generating comparison plots\nCreate comparative visualization:\n\nPlot both RMSD curves on a single graph:\n\nLine 1: With molecular glue (rapamycin)\nLine 2: Without molecular glue\n\nUse different colors/styles to distinguish the two conditions\nInclude proper labels and legend\n\n\n\n\n\n\n\nQ4 What are the average RMSD values for the second half of each simulation (t &gt; 15ns)?\n\n\n\n\nWith molecular glue: _____\nWithout molecular glue: _____\n\n\n\n\n\n\n\n\n\nQ5 What differences do you observe in the RMSD profiles between the two simulations? (1-2 sentences)."
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html",
    "title": "Molecular Docking Analysis",
    "section": "",
    "text": "The goal of this practical is to understand how molecular glue stabilizes protein-protein interactions. We will work with FKBP12 – a small cytosolic immunophilin and the FRB domain of mTOR. Rapamycin acts as the bridge that “glues” them together, forming a stable FKBP12/rapamycin/FRB ternary complex. When this complex forms, mTOR signaling is reduced, cells decrease anabolic programs (e.g., protein synthesis and growth), slow or arrest the cell cycle, and often increase autophagy.\nIn this practical, we will perform molecular docking to dock the molecular glue in the interface of two proteins and then we will compare the docking result with the co-crystallized pose.\n\n\n\n\n\n\nCreate a new working directory\n\n\n\n# Create a new folder for this practical\nmkdir -p /cephyr/NOBACKUP/groups/n2bin-gu/students/&lt;y/n&gt;/BIO512/MD\nOpen a new desktop session on Vera via OnDemand, then do the following:\n\nOpen your symlinked folder to the BIO512 group directory (i.e. /cephyr/NOBACKUP/groups/n2bin-gu/) using the file manager\nFind the directory with the install_yasara executable (in ./BIO512/jalil) and make a copy of the folder to your home directory and execute it (you might need to wait a moment)\nOnce YASARA is open, go Options &gt; Working directory &gt; navigate and find your ‘MD’ folder &gt; OK to set your working directory\n\nWe also recommend using jupyter lab for the notebook submission, since base64 encoding of images is a simple drag and drop operation in jupyter lab. To launch jupyter lab, please do the following (locally ofc):\n# Launch the BIO512_v1 env \nconda activate BIO512_v1\n\n# Launch jupyter lab\njupyter lab \n\n\n\n\n\n\n\n\nLearning Objectives\n\n\n\nBy the end you should be able to:\n\nPrepare protein structures for molecular docking using YASARA\nPerform protein-ligand docking simulations\nAnalyze docking results and binding energies"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#setting-up-the-structure",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#setting-up-the-structure",
    "title": "Molecular Docking Analysis",
    "section": "2.1 Setting up the structure",
    "text": "2.1 Setting up the structure\nDownload the structure:\n\nFile &gt; Load &gt; PDB file from Internet &gt; 3FAP\n\nIn the right-hand panel, you can see 3FAP. Click on it to expand it. There are five molecules under 3FAP:\n\nMol A = chain A of the protein\nMol B = chain B of the protein\n\nMol A = ligand (rapamycin)\nMol A (in red) = water molecules of chain A\nMol B (in red) = water molecules of chain B"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#structure-cleaning-and-preparation",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#structure-cleaning-and-preparation",
    "title": "Molecular Docking Analysis",
    "section": "2.2 Structure cleaning and preparation",
    "text": "2.2 Structure cleaning and preparation\nRemove water molecules:\n\nFrom the right-hand panel, right-click on both water entries and click ‘Delete’\n\nAdd missing hydrogen atoms:\n\nEdit &gt; Clean &gt; All\n\nMinimize the energy of the system:\n\nOptions &gt; Choose Experiment &gt; Energy minimization\n\n\n\n\n\n\n\nTroubleshooting\n\n\n\nOn Linux, you may need to pause the minimization if it hangs: Options &gt; Control experiment &gt; Pause/Continue\n\n\nDelete SimCell:\n\nFrom the right-hand panel, right-click on SimCell and Delete\n\nSave the prepared complex:\n\nFile &gt; Save as &gt; PDB file &gt; select 3FAP from both Sequence and Name panels &gt; give a name (3FAP_complex.pdb)"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#splitting-the-complex-and-saving-the-individual-components",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#splitting-the-complex-and-saving-the-individual-components",
    "title": "Molecular Docking Analysis",
    "section": "3.1 Splitting the complex and saving the individual components",
    "text": "3.1 Splitting the complex and saving the individual components\nSplit receptor and ligand:\n\nFrom the right-side panel, right click on 3FAP &gt; split &gt; Split at selected molecules &gt; select the ligand (second A in the sequence panel)\nNow you can see two objects in the right-hand panel: receptor and ligand\n\n\n\n\n\n\n\nVisualization tip\n\n\n\nYou can change the color of the receptor and ligand by right-clicking on them in the right-hand panel. It should make it much easier to see the ligand.\n\n\nRename the objects:\n\nRight click on the receptor object &gt; Name &gt; enter “Receptor”\nRight click on the ligand object &gt; Name &gt; enter “Ligand”\n\nSave the receptor:\n- File &gt; Save as &gt; PDB file &gt; select Receptor &gt; OK &gt; give a name (3FAP_receptor.pdb)\nSave the ligand:\n- File &gt; Save as &gt; Other file format &gt; select Ligand from the Object panel &gt; find sdf-MDL Mol from the Format panel &gt; enter a name (3FAP_ligand) &gt; OK\nAt this point, you should have three files in your working directory:\n\n3FAP_complex.pdb\n3FAP_receptor.pdb\n3FAP_ligand.sdf"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#defining-the-simulation-cell",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#defining-the-simulation-cell",
    "title": "Molecular Docking Analysis",
    "section": "4.1 Defining the simulation cell",
    "text": "4.1 Defining the simulation cell\nGenerate the simulation cell:\n- From the right-hand panel, right-click on Ligand object &gt; Select &gt; newly\n- Then Simulation &gt; Define simulation cell &gt; around selected atoms\nRemove the ligand:\n- Right-click on the Ligand object &gt; Delete\nSave the receptor + simulation cell:\n- File &gt; Save as &gt; YASARA Scene &gt; give a name (3FAP_receptor.sce)"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#running-the-docking-simulation",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#running-the-docking-simulation",
    "title": "Molecular Docking Analysis",
    "section": "4.2 Running the docking simulation",
    "text": "4.2 Running the docking simulation\nSet up docking:\n- Options &gt; Macro & Movie &gt; set target &gt; select 3FAP_receptor.sce &gt; select 'from underscore' &gt; OK\nRun docking:\n- Options &gt; Macro & Movie &gt; Play macro &gt; find and click on dock_run.mcr &gt; OK\n\n\n\n\n\n\nFinding the dock_run.mcr macro\n\n\n\nThe dock_run.mcr macro is located in the BIO512/jalil folder that you copied, it should be found immediately when you open the macro selection window."
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#binding-energy-analysis",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#binding-energy-analysis",
    "title": "Molecular Docking Analysis",
    "section": "5.1 Binding energy analysis",
    "text": "5.1 Binding energy analysis\nAnalyze the results:\n- Check for the log file (3FAP.log) in the working directory\n- Look at the binding energy values in the first table (Bind.energy)\n- The first entry always has the best binding energy value\n\n\n\n\n\n\nQ1 What is the binding energy of the best docking pose?"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#visual-inspection-of-docking-poses",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#visual-inspection-of-docking-poses",
    "title": "Molecular Docking Analysis",
    "section": "5.2 Visual inspection of docking poses",
    "text": "5.2 Visual inspection of docking poses\nOpen predicted and crystal structures:\n- Open the best predicted binding pose (3FAP_001.yob) by YASARA (drag and drop)\n- Open the crystal structure of the ligand (3FAP_ligand.sdf) (drag and drop)\nOptimize visualization:\n- View &gt; Hide atoms &gt; Aliphatic hydrogens\n- View &gt; Style atoms &gt; Stick &gt; ALL\n- View &gt; Hide atoms &gt; Molecule &gt; A (first entry in the Sequence panel)\n- View &gt; Hide atoms &gt; Molecule &gt; A (second entry in the Sequence panel)\n\n\n\n\n\n\nQ2 Visually inspect how well the crystal pose and the predicted docking pose overlapped. Do you see a big difference? (1 sentence)"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#quantitative-assessment",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_MOLECULAR_DOCKING.html#quantitative-assessment",
    "title": "Molecular Docking Analysis",
    "section": "5.3 Quantitative assessment",
    "text": "5.3 Quantitative assessment\nCalculate RMSD from crystal pose:\n- Color the molecules to detect the crystal ligand and docked ligand more easily\n- Analyze &gt; RMSD of &gt; Molecules &gt; docked ligand &gt; OK &gt; crystal ligand &gt; OK &gt; select Molecule &gt; OK\n- The RMSD value will be displayed in the panel below the screen\n\n\n\n\n\n\nQ3 What is the RMSD between your predicted pose and the crystal structure? Is this considered a successful prediction?\n\n\n\n\n\n\n\n\n\n\n\n\nSuccess Criteria\n\n\n\nUsually, RMSD &lt; 2.0 Å is considered as a successful docking simulation."
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html",
    "title": "Data Grouping and Visualization",
    "section": "",
    "text": "This companion to the DeSeq practical focuses on grouping, advanced PCA using DE-only genes, and sample correlation heatmaps. We will continue in the same notebook as last time, so no need to make a new workspace."
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html#questions",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html#questions",
    "title": "Data Grouping and Visualization",
    "section": "2.1 Questions",
    "text": "2.1 Questions\n\nQ12: Do you see any improvement in the separation of the Normal and Infected group? What variable(s) that you observe?\nQ13: Explain what is “loading” in PCA. Identify top-loading (best performing features) separating Normal and Infected groups. (hint: https://erdogant.github.io/pca/pages/html/Algorithm.html#loadings)"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html#steps",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html#steps",
    "title": "Data Grouping and Visualization",
    "section": "3.1 Steps",
    "text": "3.1 Steps\n\nCalculate the sample correlations using “.corr()” functions from pandas. Remember that we want to calculate the distance between samples rather than among genes.\n\n\n\n\n\n\n\nTip\n\n\n\nSuggestion: use the count_PCA variable instead of count\nhttps://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html\n\n\ncorr = {__}\n\nUse sns.clustermap() to plot your correlation matrix\n\n\n\n\n\n\n\nTip\n\n\n\nSuggestion: use “cmap = ‘RdYlBu’” to have better color map\n\n\nsns.clustermap({__})"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html#questions-1",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ADVANCED.html#questions-1",
    "title": "Data Grouping and Visualization",
    "section": "3.2 Questions:",
    "text": "3.2 Questions:\n\nQ14: What do you conclude from the clustering, do the PCA and the heatmap reflect eachother? Are there any sample outliers?\nQ15: Can you identify which correlation method that you use?\n\n\n\n\n\n\n\nTip\n\n\n\n(hint: read https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BIO512 Transcriptomics and Protein Structure Analysis - Practical Repository",
    "section": "",
    "text": "This repository contains practical exercises for the BIO512 course at University of Gothenburg. Use the navbar to navigate to the different sections.\n\n\n\nDESeq2 workflow:\n\nPractical: DESeq2 Analysis\nPractical: Data Grouping and Visualisation\n\nNetwork analysis:\n\nPractical: Network visualisation and Centrality analysis\n\n\n\n\n\n\nPeptide classification in Scikit-Learn:\n\nPractical: Peptide Classification with ML\n\n\n\n\n\n\nStructure analysis (YASARA):\n\nPractical: Protein Complex Structure Analysis\n\nStructure prediction:\n\nPractical: AlphaFold3 Prediction\n\nDocking and MD:\n\nPractical: Molecular Docking\nPractical: MD Analysis\n\n\n\n\n\n\nComputer setup:\n\nPre-course Setup\n\nHPC Cluster access:\n\nSetting up the HPC\n\n\n\nFor questions or issues, please contact the course instructors."
  },
  {
    "objectID": "index.html#course-overview",
    "href": "index.html#course-overview",
    "title": "BIO512 Transcriptomics and Protein Structure Analysis - Practical Repository",
    "section": "",
    "text": "This repository contains practical exercises for the BIO512 course at University of Gothenburg. Use the navbar to navigate to the different sections.\n\n\n\nDESeq2 workflow:\n\nPractical: DESeq2 Analysis\nPractical: Data Grouping and Visualisation\n\nNetwork analysis:\n\nPractical: Network visualisation and Centrality analysis\n\n\n\n\n\n\nPeptide classification in Scikit-Learn:\n\nPractical: Peptide Classification with ML\n\n\n\n\n\n\nStructure analysis (YASARA):\n\nPractical: Protein Complex Structure Analysis\n\nStructure prediction:\n\nPractical: AlphaFold3 Prediction\n\nDocking and MD:\n\nPractical: Molecular Docking\nPractical: MD Analysis\n\n\n\n\n\n\nComputer setup:\n\nPre-course Setup\n\nHPC Cluster access:\n\nSetting up the HPC\n\n\n\nFor questions or issues, please contact the course instructors."
  },
  {
    "objectID": "setup/Set_up_the_HPC.html",
    "href": "setup/Set_up_the_HPC.html",
    "title": "n2bin: Connecting to the HPC",
    "section": "",
    "text": "1 Introduction\nThis tutorial is to take you through the final steps of setting up and accessing the c3se High Performance Computing infrastructure. The specific cluster we will use is called Vera. You will be introduced to this cluster in the lecture and here you can find more information about it, including what resources that are available, how to run jobs and other documentation.\nWe will walk you through step by step in this tutorial so that we (hopefully) can assist if there are any problems.\n\n\n\n\n\n\nPre-course setup\n\n\n\nTo be able to follow these steps you first have to have followed the steps of the Pre-course Setup including registration at SUPR and application to the course HPC project.\n\n\n\n\n\n2 Setting up a Chalmers ID - IF you have the option to do so in the login portal - else continue to next step\n\nNavigate to https://myaccount.chalmers.se/.\nLog in with your GU account.\nChoose “Activate CID” and follow the instructions to activate your account\n\n\n\n\n\n\n\nRemember your password!\n\n\n\nThe CID username and password are the ones you will use to log in to the cluster\n\n\n\n\n\n3 Adding Vera/c3se at SUPR\n\nLog in to SUPR\nClick “Accounts” in the left side menu\nRequest access to Vera/c3se\n\n\n\n\n\n\n\nProceed even without a CID\n\n\n\nIf you don’t have that option in the CID portal you should apply for Vera access in SUPR anyway. They will then assign you a CID that you can access and create a PW for in the CID portal when you have received an email notification about this.\n\n\n\n\n\n4 Setting up Chalmers VPN (if you don’t already have a GU VPN)\nTo be able to access c3se from other networks than in GU or Chalmers, you will need a Chalmers VPN\n\nNavigate to https://chalmers.topdesk.net/tas/public/ssp/content/detail/knowledgeitem?unid=07e6154089a648d09711ccc42a42fc88\nFollow the instructions to set up the Chalmers VPN\n\n\n\n\n5 Connecting to the HPC using ssh in VSCode\nTo be able to connect to the HPC in a manner that will let you use the full suite of tools available (or most of them at least) in VSCode, you will need to install the Remote - SSH extension.\n\nOpen VSCode\nGo to the Extensions view by clicking on the Extensions icon in the Activity Bar on the side of the window or by pressing Ctrl+Shift+X\nSearch for “Remote - SSH” and install the extension by Microsoft (if youre unsure how install extensions, see here)\nAfter installation, you will see a new icon in the Activity Bar on the side of the window. Click on it to open the Remote Explorer view.\n\nIf the SSH Targets are not visible, click on the drop down to expand the view\n\nClick on the + (“New Remote”) icon next to SSH header to add a new SSH host\nIn the input box that appears, enter the SSH connection string for Vera: &lt;your_chalmers_id&gt;@vera1.c3se.chalmers.se (replace &lt;your_chalmers_id&gt; with your actual Chalmers ID)\nPress Enter to confirm\nYou will be prompted to select the SSH configuration file to update. Choose the default option (usually ~/.ssh/config)\n\nOnce you have added the SSH host, you can connect to Vera:\n\nIn the Remote Explorer view, find the Vera entry under SSH Targets (or by clicking on the blue “remote window” icon in the bottom left corner of VSCode)\n\nClick on the “Connect to Host” icon (an arrow if you want the same window, square if you want a new one) next to the Vera entry\nIf you clicked on the blue “remote window” icon, select “Remote-SSH: Connect to Host…” and then select the Vera entry\n\nA new VSCode window will open, and you will be prompted to enter your Chalmers ID password\nAfter entering your password, you should be connected to Vera, and you can start working on the HPC cluster directly from VSCode. Make sure that you open your home folder on Vera to open up a workspace.\nYou can verify that you are connected to Vera by opening a new terminal in VSCode (Terminal &gt; New Terminal) and checking the hostname in the terminal prompt. It should show something like your_chalmers_id@vera:~$"
  },
  {
    "objectID": "setup/Pre-course-setup_n2bin.html",
    "href": "setup/Pre-course-setup_n2bin.html",
    "title": "Pre-course setup",
    "section": "",
    "text": "Here is a tutorial to guide you through how to set up your computers for the BIO511 and following courses. Throughout the course we will both teach you how to use your local computer for bioinformatics but also, for more heavy duty stuff, use the c3se high performance computing cluster (HPC). The setup will therefore prepare you for both cases.\nSome of you might already have done some kinds of bioinformatics and have other setups and if you are comfortable with those, that’s fine by us. We will however not be able to give support/trouble shoot different kinds of setups so we ask you to make sure you have what’s below as a minimum."
  },
  {
    "objectID": "setup/Pre-course-setup_n2bin.html#welcome-to-the-world-of-bioinformatics",
    "href": "setup/Pre-course-setup_n2bin.html#welcome-to-the-world-of-bioinformatics",
    "title": "Pre-course setup",
    "section": "",
    "text": "Here is a tutorial to guide you through how to set up your computers for the BIO511 and following courses. Throughout the course we will both teach you how to use your local computer for bioinformatics but also, for more heavy duty stuff, use the c3se high performance computing cluster (HPC). The setup will therefore prepare you for both cases.\nSome of you might already have done some kinds of bioinformatics and have other setups and if you are comfortable with those, that’s fine by us. We will however not be able to give support/trouble shoot different kinds of setups so we ask you to make sure you have what’s below as a minimum."
  },
  {
    "objectID": "setup/Pre-course-setup_n2bin.html#setup-for-mac-linux-users",
    "href": "setup/Pre-course-setup_n2bin.html#setup-for-mac-linux-users",
    "title": "Pre-course setup",
    "section": "2 Setup for Mac / Linux users",
    "text": "2 Setup for Mac / Linux users\nmacOS is Unix-based (specifically, it’s a certified Unix system built on BSD) and therefore one can run many Linux-compatible tools without modification directly. You can basically just use the built in Terminal app and start coding. The Terminal runs the zsh shell by default.\nHowever, to get a better user experience, especially when we further on are going to access the HPC we will recommend using the integrated development environment (IDE) Visual Studio Code (VS Code). Please follow these instructions to do so."
  },
  {
    "objectID": "setup/Pre-course-setup_n2bin.html#setup-for-windows-users",
    "href": "setup/Pre-course-setup_n2bin.html#setup-for-windows-users",
    "title": "Pre-course setup",
    "section": "3 Setup for Windows users",
    "text": "3 Setup for Windows users\nUsing a Windows computer for bioinformatic work has sadly not been ideal most of the time, but large advances in recent years have made this quite feasible through the Windows Subsystem for Linux (WSL).\nApart from the Linux kernel provided by WSL, we also recommend installing the integrated development environment (IDE) Visual Studio Code (VS Code), and the tutorial will guide you through how to set up WSL integrated in VS Code. If you already feel comfortable with another IDE such and PyCharm since before, that’s ok but we may not be able to trouble shoot your setup during the course.\nThere are two substantially different versions of the Linux subsystem, WSL1 and WSL2. We strongly recommend using WSL2, which offers an essentially complete Linux experience and better performance.\nUsing the Linux subsystem will give you access to a full command-line bash shell and a Linux implementation on your Windows 10 or 11 PC. For the difference between the Linux Bash Shell and the Windows PowerShell, see e.g. this article.\nThe installation has three main steps:\n\nInstall WSL2 on Windows 10 or 11, follow the instructions here: Installing the Windows Subsystem and the Linux Bash\n\n\n\n\n\n\n\nNote\n\n\n\nIf you run into error messages when trying to download files through the Linux shell (e.g. curl:(6) Could not resolve host) then try adding the Google name server to the internet configuration by running sudo nano /etc/resolv.conf then add nameserver 8.8.8.8 to the bottom of the file and save it.\n\n\n\n\n\n\n\n\nCaution\n\n\n\nWhenever a setup instruction specifies Mac or Linux (i.e. only those two, with no alternative for Windows), please follow the Linux instructions.\n\n\n\nInstall Visual Studio Code on the Windows side (not in WSL).\n\n\n\n\n\n\n\nNote\n\n\n\nNote: When prompted to Select Additional Tasks during installation, be sure to check the Add to PATH option so you can easily open a folder in WSL using the code command.\n\n\n\nInstall the WSL extension. If you plan to work with other remote extensions in VS Code, you may choose to install the Remote Development extension pack."
  },
  {
    "objectID": "setup/Pre-course-setup_n2bin.html#getting-access-to-the-high-performance-computing-cluster-c3se",
    "href": "setup/Pre-course-setup_n2bin.html#getting-access-to-the-high-performance-computing-cluster-c3se",
    "title": "Pre-course setup",
    "section": "4 Getting access to the High Performance computing cluster c3se",
    "text": "4 Getting access to the High Performance computing cluster c3se\nNow you have your local computer setup for bioinformatics. However, for many of the practicals we will use a high performance computing cluster, both so that you get familiar with that way of working, to keep a more controlled environment for you in the beginning and to let you perform analyses that require a bit more heavy duty computing power than your local machines.\nThis setup will be the same regardless of your OS.\n\nRegister yourself at SUPR. SUPR is the database for the National Swedish Infrastructure for Supercomputing (NAISS) and SUPR is used to keep track of persons, projects, project proposals and more. Please register with Federated Identity using your GU email address.\nWhen you have registered, please send an email to kaisa.thorell@gu.se and I will add you to the c3se project."
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "",
    "text": "In this practical, you will perform differential expression analysis using PyDESeq2, explore the data structure with PCA, and interpret results via GO Biological Process enrichment. You will work from the count data we generated in the previous practical, but double check that it matches the data provided. If it doesnt match or you dont have it, you can use the provided counts.tsv.\nEnsure these files are in your working directory before starting the analysis (some need to be copied in).\n\nCount matrix: counts.tsv (from the previous segment)\nSample metadata: metadata.txt\n\n\n\n\n\n\n\nSetup Instructions\n\n\n\nmkdir -p ~/BIO512/DESeq_lab\ncd ~/BIO512/DESeq_lab\n\n# Required files can be fetched from the Cluster\nscp -r &lt;your_vera_username&gt;@vera2.chalmers.se:/cephyr/NOBACKUP/groups/n2bin_gu/BIO512/practicals/DeSeq/* ~/BIO512/DESeq_lab\ncd ~/BIO512/DESeq_lab\n\n# Build the conda environment needed from the provided environment file\nconda env create --file=\"./env/env.yml\"\n\nconda activate BIO512_v1\n\nipython kernel install --user --name=BIO512_v1\n\n# Launch Jupyter Lab or run the notebook in VScode\n\n# For any excersise that has a {__}, this is a placeholder that you need to fill in with appropriate code.\nmyvariable = {__}\n# should be replaced with actual code.\nmyvariable = \"Hello, World!\""
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#steps",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#steps",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "3.1 Steps",
    "text": "3.1 Steps\n\nLet’s use the 2nd initialization method, limiting the PCs to 3\n\nmodel = pca(n_components={__})\n\nSetting up the dataframe for analysis\n\nRemove the all zero genes from our count file, by keeping only the rows with total sum greater than 0. Assign it to “count_PCA”.\nReplace the sample ID to their conditions (normal or infected) (Tips: we make sure that the sample sequence in the count file is the same with metadata)\n\nHint: A pythonic way to do this count_PCA = count_PCA.rename(columns = metadata[\"Conditions\"])\n\nLog-transform the count_PCA. Read about “log1p” function from numpy, what does it mean?\n\n\n# Setting up the dataframe for analysis\n## 1. Remove the all zero genes from our count file, by keeping only the rows with total sum greater than 0. Assign it to \"count_PCA\".\ncount_PCA = count[{__}]\n\n## 2. Replace the sample ID to their conditions (normal or infected)\n### 2.1. we make sure that the sample sequence in the count file is the same with metadata (Yes it is in this example, but it is not going to always be like that :D)\ncount_PCA = count_PCA[metadata.index]\n\n### 2.2. replacing the column names with their metadata[\"Conditions\"] column\ncount_PCA.columns = {__}\n\n\n## 3. Log-transform the count_PCA. Read about \"log1p\" function from numpy, what does it mean?\ncount_PCA = {__}\n\nPerform the PCA analysis, on logged data using model.fit_transform() function (Note: This package requires gene names as the column names and the sample ID as the row names, so we have to transpose our dataframe (.T in the end))\n\nresults = model.{__}\n\nPlot the PCA analysis with a scatter plot (Note: figsize option is to limit the dimension of the plot. Can be adjusted to fit your preference. Play around with it.)\n\nfig, ax = {__}"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#questions",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#questions",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "3.2 Questions:",
    "text": "3.2 Questions:\n\nQ2: What is your interpretation of the PCA analysis? Is there any outliers? Justify your opinion.\nQ3: Is the plot title total variant same as the PC1 + PC2 explained variant? If not, why?\n\n\n\n\n\n\n\nPCA Cheatsheet:\n\n\n\n\nmodel.scatter3d() –&gt; 3D PCA plotting\nmodel.biplot() –&gt; Plotting top loading factors (model.biplot3d for 3D PCA)\nExplore “model.results” for detailed information of the PCA model, including “explained_var”, “variance_ratio”, “loadings”, etc\n\nMore info: https://erdogant.github.io/pca/pages/html/index.html"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#steps-1",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#steps-1",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "4.1 Steps:",
    "text": "4.1 Steps:\n\nCreate dds object. Use the original unfiltered count and metadata variables. For the design option, let’s use the “Conditions” column on metadata\n\ndds = DeseqDataSet(\n    counts=count.T,\n    metadata=metadata,\n    design=\"~Conditions\",\n    refit_cooks=True,\n)\n\nPerform the DESeq2 analysis with deseq2() function on the dds object (It may take a few mins)\n\ndds.deseq2()\nOPTIONAL: Look at the sub-variables inside the dds object\n\nPerform the comparison between Infected and Normal group using DeseqStats() function\n\nds = DeseqStats(dds, contrast=[\"Conditions\", \"Infected\", \"Normal\"])\n\nRetrieve the results and assign it to a different object, e.g. deseq_results (hint: ds.results_df after running ds.summary()).\n\nRemember that since we are doing a lot of tests, as many tests as genes in our experiment, we need to correct our pvalues. DESeq already did this while testing for differences among our groups, so let’s create a histogram of these adjusted pvalues and an MA-plot to inspect if there is any enrichment of DE genes.\nds.summary()\ndeseq_results = ds.results_df\n\nMake a histogram using the hist() function on the padj column of the results object. Change arguments in the placeholder to make a nice histogram (eg. add some color, a title etc.) https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.hist.html\n\ndeseq_results[\"padj\"].hist(bins = 100, {__})\n\nCreate a MA-plot with the plot_MA() function from DeseqStats object (not dds!).\n\nds.plot_MA()\n\nLet’s remove the genes with NAN adjusted p-values. Use the .notna() function on the padj column of the results object to keep those that has valid adjusted p-values.\n\n\n\n\n\n\n\nTip\n\n\n\nhttps://pandas.pydata.org/docs/reference/api/pandas.DataFrame.notna.html\nThere are genes that have very low counts across all the samples, these can’t be tested for DE so they end up with an NA p-adj. Let’s remove them. Use the isna() function on the padj column of the results object. This will test if the padj is NA.\nThere should be 953 valid genes.\n\n\nnotna_deseq = {__}\nnotna_deseq.shape"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#questions-1",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#questions-1",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "4.2 Questions:",
    "text": "4.2 Questions:\n\nQ4: How many significantly differentially expressed genes in this comparison? (padj &lt; 0.05)\nQ5: What does the histogram tell you? Looking at the MA plot, approximately what are your highest and lowest Foldchanges?\nQ6: How many genes with a p-adjusted value of NA did you have?\nQ7: What is the top 5 most significantly differentially expressed genes based on their log2FoldChange? (padj &lt; 0.05)Look for their gene names using online tools (e.g. ENSG00000166211 is SPIC).\n\n\n\n\n\n\n\nTip\n\n\n\nRemember: There are up and down-regulated genes, make sure that you sort it based on their absolute values. Hint: .sort_values(“log2FoldChange”, key = abs)\n\n\nnotna_deseq[notna_deseq[\"padj\"] &lt; 0.05].sort_values(\"log2FoldChange\", key = abs)\n\n\n\n\n\n\nNote\n\n\n\nSave the normalized count from DESeq2 and final result without the NAs as a tab-separated file\ninclude the non-significant genes too. We will use this in our future lab on network and visualization.\n\n\nnotna_deseq[notna_deseq[\"padj\"] &lt; 0.05].to_csv(\"Deseq2_Results.txt\", sep = \"\\t\")\npd.DataFrame(dds.layers[\"normed_counts\"], columns = dds.var_names, index=dds.obs_names).T.to_csv(\"Deseq2_NormalizedCount.txt\", sep = \"\\t\")"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#steps-2",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#steps-2",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "5.1 Steps",
    "text": "5.1 Steps\n\nSince our the gene names are using “Ensembl Gene ID” and most enrichment analysis packages supports only “Gene Name” or “HGNC ID”, let’s first convert them. We will use the pyBioMart package to help us retrieving the mapping file.\n\n\n\n\n\n\n\nTip\n\n\n\nhttps://jrderuiter.github.io/pybiomart/api.html\nNOTE: Gseapy package has similar functions, but pyBioMart package can give a more flexible implementation option in larger data\n\n\n# Starting connections to ensembl website using the \"Dataset\" function from pyBioMart\ndataset = Dataset(name='hsapiens_gene_ensembl', host='http://www.ensembl.org')\n\n# Retrieving name mapping dataframe between \"Esembl ID\" and External Gene Name (HGNC)\nmapping = dataset.query(attributes=['ensembl_gene_id', 'external_gene_name'])\n\n#Look at the mapping structure\nmapping.head()\n# Let's copy the deseq results again, focusing only on differentially expressed genes\nsignificant_deseq = deseq_results[deseq_results[\"padj\"] &lt; 0.05]\n\n# Now we are merging the mapping dataframe to the significant_deseq object. read more on Pandas Merging function if needed\nsignificant_deseq = significant_deseq.merge(mapping, left_index = True, right_on = \"Gene stable ID\")\n\n#Letäs remove those with no gene names\nsignificant_deseq = significant_deseq[significant_deseq[\"Gene name\"].notna()]\n\n#Look at the new significant_deseq structure\nsignificant_deseq.head()\n\n# Now we have \"Gene Name\" columns that we can use for enrichment analysis\n\nMake two lists of significantly differentially expressed genes (signficant_deseq object): up and down-regulated genes (use the Gene name columns)\n\n\nup-regulated: Log2FoldChange &gt; 0 (and padj &lt; 0.05) –&gt; 80 genes\ndown-regulated: Log2FoldChange &lt; 0 (and padj &lt; 0.05) –&gt; 66 genes\n\n\n\n\n\n\n\nTip\n\n\n\nhint: use .to_list() function to convert pandas series to list.\nhttps://pandas.pydata.org/docs/reference/api/pandas.Series.to_list.html\n\n\nup = {__}\ndown = {__}\nlen(up)\nlen(down)\n\nPerform enrichment analysis using Enrichr API from GSEAPY. Do one enrichment analysis for each direction (one for up and one for down-regulated genes). For uniformity, please use the object name enr_up and enr_down.\n\n\n\n\n\n\n\nTip\n\n\n\nhttps://gseapy.readthedocs.io/en/latest/gseapy_example.html#Enrichr-Web-Serives-(without-a-backgound-input)\n\n\nenr_up = {__}\nenr_down = {__}\n\nTo get detailed output of the enrichment analysis results in dataframe format, access the .res2d variable under enr_up and enr_down\n\nenr_up.res2d.head()\nenr_down.res2d.head()\n\nPlot the enrichment analysis results focusing on the top 10 most enriched processes for each up and down-regulated genes. Explore all the plotting options and pretify it with the options. (use the option cutoff=1, since we do not have that many genes to enrich)\n\n\n\n\n\n\n\nTip\n\n\n\nhttps://gseapy.readthedocs.io/en/latest/gseapy_example.html#Plotting\n\n\nax = {__}\nax = {__}"
  },
  {
    "objectID": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#questions-2",
    "href": "practicals/PRACTICALS-DESeq/PRACTICAL_DESEQ_ANALYSIS.html#questions-2",
    "title": "Differential Expression and Enrichment Analysis",
    "section": "5.2 Questions:",
    "text": "5.2 Questions:\n\nQ8: How many significantly enriched processes for up- and down-regulated genes? (Adjusted P-value &lt; 0.11, arbitrary cut off)\nQ9: What does “Combined Score” mean? Check https://maayanlab.cloud/Enrichr/help#basics\nQ10: What are the genes associated with the process with the highest combined score in each direction?\nQ11: What are the top 10 enriched processes for the up- and down-regulated genes? Include a figure for each direction.\n\n\n\n\n\n\n\n\nThings to append to your submission\n\n\n\n\nSave your notebook as PRACTICAL_DESEQ_ANALYSIS_yourname.ipynb\nAdd answers to the questions in separate markdown cells\nAdd your code blocks from the jupyter notebook with completed code where the placeholders were\nInclude some output cells with figures (if multiple runs are needed, keep only the last one)"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html",
    "title": "Gene Co-Expression Network Analysis",
    "section": "",
    "text": "In this practical, we will construct (or load) a gene co-expression network from normalized RNA-seq counts and analyze its topology. You will compute centrality measures, detect modules via Leiden clustering, and perform functional enrichment on selected clusters.\n\n\n\n\n\n\nSetup Instructions\n\n\n\nmkdir -p ~/BIO512/Network_analysis\ncd ~/BIO512/Network_analysis\n\n# Required files can be fetched from the Cluster\nscp -r &lt;your_vera_username&gt;@vera2.chalmers.se:/cephyr/NOBACKUP/groups/n2bin_gu/BIO512/Network_analysis/* ~/BIO512/Network_analysis/\n\n# Remember to activate the conda environment\nconda activate BIO512_v1\n# Launch Jupyter Lab or run the notebook in VScode\n\n# For any excersise that has a {__}, this is a placeholder that you need to fill in with appropriate code.\nmyvariable = {__}\n# should be replaced with actual code.\nmyvariable = \"Hello, World!\""
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#questions",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#questions",
    "title": "Gene Co-Expression Network Analysis",
    "section": "3.1 Questions",
    "text": "3.1 Questions\n\nQ1: How many nodes and edges?\nQ2: Network diameter and density? Interpret their meaning.\n\ng.vcount()\ng.ecount()\ng.diameter()\ng.density()"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#questions-1",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#questions-1",
    "title": "Gene Co-Expression Network Analysis",
    "section": "4.1 Questions",
    "text": "4.1 Questions\n\n\n\n\n\n\nTip\n\n\n\nHint 1: The output of centrality measures in iGraph Python are lists. To convert to Pandas Series for easy analysis, use pd.Series(list, index = g.vs[\"name\"])\nHint 2: Use the Pandas sort_values function to rank the Series https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html\n\n\n\nQ3: Which genes are hubs (high degree centrality)? (top 10)\n\nQ4: Which genes act as bridges between modules (high betweenness)? (top 10)\n\nQ5: Perform Closeness and Eigenvector centrality analysis. Looking at top 40 most central genes for each measurement, is there any intersection between different methods? Which methods are more similar? Why?\n\nQ6: Compare biological functions of hub vs. bridge genes — do they play different roles? (Hint: Use the Enrichr website or GSEAPY module from DESeq2 lab to identify their functions) https://maayanlab.cloud/Enrichr/\n\n# Calculate centrality measures\ndegree_centrality = {__}\nbetweenness_centrality = {__}\ncloseness_centrality = {__}\neigenvector_centrality = {__}\n\n# Add centrality values as node attributes\ng.vs[\"degree\"] = degree_centrality\ng.vs[\"betweenness\"] = betweenness_centrality\ng.vs[\"closeness\"] = closeness_centrality\ng.vs[\"eigenvector\"] = eigenvector_centrality\n\n# Create a DF to present different centrality analyses\ncentrality_df = pd.DataFrame({\n    \"gene\": g.vs[\"name\"],\n    \"degree\": degree_centrality,\n    \"betweenness\": betweenness_centrality,\n    \"closeness\": closeness_centrality,\n    \"eigenvector\": eigenvector_centrality\n})"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#optional-advance-plotting-use-centrality-variables-as-the-node-size",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#optional-advance-plotting-use-centrality-variables-as-the-node-size",
    "title": "Gene Co-Expression Network Analysis",
    "section": "4.2 Optional: Advance Plotting: Use centrality variables as the node size",
    "text": "4.2 Optional: Advance Plotting: Use centrality variables as the node size\nfig, ax = plt.subplots() ## We are using matplotlib for the visualization, otherwise there are many other requirements to install\nig.plot(\n    g,\n    layout = layout,\n    target=ax, # this option is to attach the plot to matplotlib\n    vertex_size=g.degree(),\n)\n\nfig.set_size_inches(20, 20) # defining the size of the canvas"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#questions-to-explore",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#questions-to-explore",
    "title": "Gene Co-Expression Network Analysis",
    "section": "5.1 Questions to Explore",
    "text": "5.1 Questions to Explore\n\nQ7: How many modules/clusters can you detect in the network?\nQ8: Which module is the largest? Which is the smallest?\nQ9: Which modules contain the most hub genes identified earlier?\nQ10: If you pick the largest module, what biological function might it represent? Make a visualization of top 10 most enriched processes\n\n\n\n\n\n\n\nTip\n\n\n\nUse the Enrichr website or GSEAPY module from DESeq2 lab to identify their functions: https://maayanlab.cloud/Enrichr/**\n\n\n\nQ11(OPTIONAL): Can you identify the hub gene(s) in the two biggest modules?\n\n\n\n\n\n\n\nTip\n\n\n\nSlice the original network using .subgraph"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#optional-task-can-you-identify-the-clusters-with-hubs-using-the-plot",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#optional-task-can-you-identify-the-clusters-with-hubs-using-the-plot",
    "title": "Gene Co-Expression Network Analysis",
    "section": "6.1 Optional Task: Can you identify the clusters with hubs using the plot?",
    "text": "6.1 Optional Task: Can you identify the clusters with hubs using the plot?\nfig, ax = plt.subplots()\nig.plot(\n    clustering,\n    target=ax,\n    layout=layout,\n    mark_groups=True,\n    #vertex_size=15,\n    vertex_size=g.degree(),\n)\nfig.set_size_inches(20, 20)"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#load-normalized-count-file",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#load-normalized-count-file",
    "title": "Gene Co-Expression Network Analysis",
    "section": "7.1 Load normalized count file",
    "text": "7.1 Load normalized count file\nIn generating gene co-expression network, we use normalized count instead of raw counts. It can be TPM, FPKM, RPKM, or any normalization. For this lab, we are going to use normalized count from the DESeq lab.\nnorm_count = pd.read_csv(\"Deseq2_NormalizedCount.txt\", sep = \"\\t\", index_col = 0)\n\n# Exclude all-zero genes \nnorm_count = norm_count[norm_count.sum(1) &gt; 0]"
  },
  {
    "objectID": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#generating-gene-co-expression-network",
    "href": "practicals/PRACTICALS-Network_Visualisation/PRACTICAL_NETWORK_ANALYSIS.html#generating-gene-co-expression-network",
    "title": "Gene Co-Expression Network Analysis",
    "section": "7.2 Generating Gene Co-Expression Network",
    "text": "7.2 Generating Gene Co-Expression Network\ndef coexpression_generation(norm_count,padj_thr=0.05):\n    print('Calculating Correlation..')\n    temp=spearmanr(norm_count.T)\n    corr=pd.DataFrame(temp[0],columns=list(norm_count.index),index=list(norm_count.index))\n    pval=pd.DataFrame(temp[1],columns=list(norm_count.index),index=list(norm_count.index))\n    print('Filtering the matrix Correlation..')\n    corr=corr.where(np.triu(np.ones(corr.shape)).astype(np.bool))\n    pval=pval.where(np.triu(np.ones(pval.shape)).astype(np.bool))\n    print('Making long table of Correlation..')\n    corr2=corr.unstack().reset_index(name='weight')\n    pval2=pval.unstack().reset_index(name='pval')\n    res=corr2.merge(pval2,on=['level_0','level_1'])\n    res=res[res['level_0'] != res['level_1']]\n    res=res.dropna()\n    print('Adjusting P-val')\n    res['padj']=multipletests(res['pval'],method='fdr_bh')[1]\n    res=res[res.padj &lt; padj_thr].reset_index(drop=True)\n    res=res[['level_0','level_1','weight']]\n    print('Done!!')\n    return res\n\ncoexp_network = coexpression_generation(norm_count)\ncoexp_network = coexp_network[coexp_network[\"weight\"] &gt; 0]\ncoexp_network.to_csv(\"coexpression_network.txt\", sep = \"\\t\", index = False)\nMap to gene names (optional):\n# Starting connections to ensembl website using the \"Dataset\" function from pyBioMart\ndataset = Dataset(name='hsapiens_gene_ensembl', host='http://www.ensembl.org')\n\n# Retrieving name mapping dataframe between \"Esembl ID\" and External Gene Name (HGNC) and focusing only on \"protein coding\" genes\nmapping = dataset.query(attributes=['ensembl_gene_id', 'external_gene_name'])\ncoexp_network.replace(mapping.set_index(\"Gene stable ID\")[\"Gene name\"]).dropna().to_csv(\"coexpression_network.txt\", sep = \"\\t\", index = False)\n\n\n\n\n\n\nNote\n\n\n\nThe output is a dataframe with 3 columns:\n\nlevel_1: gene node 1\nlevel_2: gene node 2\nweight: correlation score"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html",
    "title": "AI-Based Protein Complex Prediction with AlphaFold3",
    "section": "",
    "text": "In this practical we continue working on the Barnase-Barstar protein complex (PDBid: 1BRS) from Bacillus amyloliquefaciens. This time, we will use AlphaFold3 (AF3) to predict the structure of the complex from sequence alone, and assess how well AF3 can predict the effects of specific mutations on the complex structure.\n\n\n\n\n\n\nPrerequisites\n\n\n\n\nCompleted analysis of 1BRS crystal structure from previous practical\nFASTA sequences of Barnase and Barstar from PDB\nGmail account for AlphaFold server access\n\n\n\n\n\n\n\n\n\nLearning Objectives\n\n\n\nBy the end you should be able to:\n\nUse AlphaFold3 server for protein complex prediction\nInterpret AF3 confidence metrics (pTM and ipTM)\nDesign and analyze mutational studies computationally\nCompare predicted structures with experimental crystal structures\nUnderstand limitations of AI-based structure prediction for mutations"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#preparing-sequences",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#preparing-sequences",
    "title": "AI-Based Protein Complex Prediction with AlphaFold3",
    "section": "2.1 Preparing sequences",
    "text": "2.1 Preparing sequences\nYou should have obtained the FASTA sequences from the previous practical. If not, go back and do so now."
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#wild-type-complex-prediction",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#wild-type-complex-prediction",
    "title": "AI-Based Protein Complex Prediction with AlphaFold3",
    "section": "2.2 Wild-type complex prediction",
    "text": "2.2 Wild-type complex prediction\nAccess AlphaFold3 server:\n\nNavigate to https://alphafoldserver.com\nLog in with your Gmail account\n\nSubmit wild-type prediction:\n\nEnter the WT sequence of Barstar (first protein)\nAdd entity as “protein”\nEnter the WT sequence of Barnase (second protein)\nAdd entity as “protein”\nClick “Continue and preview job”\nGive a name to the job: wtBarnase-wtBarstar\nSubmit the job\n\n\n\n\n\n\n\nProcessing time\n\n\n\nAF3 jobs can take several hours to complete. If the server is busy, it may take a very long, use the precomputed results available on Vera then instead.\n\n\nDownload results: - Once completed, click on the job\n\n\n\n\n\n\nTip\n\n\n\nNote the confidence metrics:\n\npTM (global metric): Confidence in individual protein structures\nipTM (interface metric): Confidence in protein-protein interface\n\n\n\n\nDownload results by clicking “Download”\nRename the file to wtBarnase_wtBarstar.zip\n\nExtract on the cluster:\n# Unzip the results\nunzip wtBarnase_wtBarstar.zip -d wtBarnase_wtBarstar"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#mutation-to-alanine-conservative",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#mutation-to-alanine-conservative",
    "title": "AI-Based Protein Complex Prediction with AlphaFold3",
    "section": "3.1 Mutation to Alanine (conservative)",
    "text": "3.1 Mutation to Alanine (conservative)\nPrepare D39A-D35A mutant sequences:\n\nTake the Barstar sequence from the FASTA file\nFind position 39 (ASP/D) and replace with Alanine (A)\nFind position 35 (ASP/D) and replace with Alanine (A)\nKeep Barnase sequence unchanged\n\nSubmit D39A-D35A prediction:\n\nEnter the mutated Barstar sequence\nEnter the WT Barnase sequence\nJob name: wtBarnase_D39A-D35ABarstar\nSubmit and download results when complete"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#mutation-to-arginine-charge-reversal",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#mutation-to-arginine-charge-reversal",
    "title": "AI-Based Protein Complex Prediction with AlphaFold3",
    "section": "3.2 Mutation to Arginine (charge reversal)",
    "text": "3.2 Mutation to Arginine (charge reversal)\nPrepare D39R-D35R mutant sequences:\n\nTake the Barstar sequence from the FASTA file\nFind position 39 (ASP/D) and replace with Arginine (R)\nFind position 35 (ASP/D) and replace with Arginine (R)\nKeep Barnase sequence unchanged\n\nSubmit D39R-D35R prediction:\n\nEnter the mutated Barstar sequence\nEnter the WT Barnase sequence\nJob name: wtBarnase_D39R-D35RBarstar\nSubmit and download results when complete\n\n\n\n\n\n\n\nQ2 Compare the predicted complexes for WT vs. mutated sequences, how do the pTM and ipTM values change for each mutation?"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#structural-comparison-with-crystal-structure",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_ALPHAFOLD3_PREDICTION.html#structural-comparison-with-crystal-structure",
    "title": "AI-Based Protein Complex Prediction with AlphaFold3",
    "section": "3.3 Structural comparison with crystal structure",
    "text": "3.3 Structural comparison with crystal structure\nPrepare YASARA for comparison: Clean up the YASARA’s screen (File &gt; New &gt; Yes) and open the prepared crystal structure from step 9 (1BRS_complex.pdb). Also open the “…model_0.cif” structure predicted by AF3 for the WT sequences (drag and drop). You can find it within the folder “wtBarnase_wtBarstar” from step18\n\n\n\n\n\n\nAF3 output format\n\n\n\nAF3 predicts 5 models (model_0 to model_4) where model_0 always has the highest-ranking confidence value.\nFor better visualization, it’s better to color each molecule in each complex differently.\n\n\nSuperpose predicted on crystal structure: Now you have two protein complexes on YASARA, crystal structure and AF3 predicted for WT sequence. Now we superpose the predicted structure on crystal structure.\n\nAnalyze &gt; Superpose &gt; Objects\nSelect “fold_wtbaranase…” (predicted structure) from Sequence panel &gt; OK\nSelect “1BRS_complex…” (crystal structure) from Sequence panel &gt; OK\nIn “Set parameters” window: Uncheck all boxes except “Residue name” and “Residue number” &gt; OK\n\nCalculate RMSD for Barstar: Then we calculate the RMSD value between Barstar proteins by\n\nColor the molecules differently to find which ones overlap\nAnalyze &gt; RMSD of &gt; Molecules\nChoose the molecules in Sequences that are superposed (for the crystal and predicted structures) &gt; OK &gt; OK\nRMSD value will be shown in the command window\n\nRepeat for mutant structures:\n\nClean up YASARA screen and repeat the superposition and RMSD calculation for both mutant predictions\n\n\n\n\n\n\n\nQ3 Complete the RMSD comparison table and place it in your report:\n\n\n\n\n\n\nComparison Pair\nRMSD (Å)\n\n\n\n\nCrystal vs WT\n\n\n\nCrystal vs D39A-D35A\n\n\n\nCrystal vs D39R-D35R\n\n\n\n\n\n\n\n\n\n\n\n\nQ4 What do the AF3 metrics and RMSD values show?\n\n\n\n\n\n\n\n\n\n\n\n\nQ5 How do you interpret this finding? Why does the mutation to Arginine have that significant effect on the predicted structure but mutation to Alanine does not?"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "",
    "text": "The goal of this practical is to apply AI-based protein complex structure prediction using AF3. You will learn the capability of AF3 in correctly predicting the protein complexes from either WT sequence or upon mutations.\nThe protein complex structure used is a classic model of protein–protein recognition “Barnase-Barstar” from Bacillus amyloliquefaciens organism (PDBid: 1BRS). Barnase is a small extracellular ribonuclease from that degrades RNA. On its own it’s toxic to the producing cell. Barstar is an intracellular protein inhibitor of Barnase. It binds Barnase extremely tightly and blocks the RNase active site, protecting the bacterium until Barnase is secreted.\n\n\n\n\n\n\nSetup Instructions\n\n\n\n# Create a new folder for this practical\nmkdir -p /cephyr/NOBACKUP/groups/n2bin-gu/students/&lt;y/n&gt;/BIO512/AF\nOpen a new desktop session on Vera via OnDemand, then do the following:\n\nOpen your symlinked folder to the BIO512 group directory (i.e. /cephyr/NOBACKUP/groups/n2bin-gu/) using the file manager\nFind the install_yasara executable (in ./BIO512/jalil) and execute it (you might need to wait a moment)\nOnce YASARA is open, go Options &gt; Working directory &gt; navigate and find your ‘AF’ folder &gt; OK to set your working directory\n\nWe also recommend using jupyter lab for the notebook submission, since base64 encoding of images is a simple drag and drop operation in jupyter lab. To launch jupyter lab, please do the following (locally ofc):\n# Launch the BIO512_v1 env \nconda activate BIO512_v1\n\n# Launch jupyter lab\njupyter lab \n\n\n\n\n\n\n\n\nLearning Objectives\n\n\n\nBy the end you should be able to:\n\nPrepare protein complex structures for analysis using YASARA\nVisualize and analyze protein-protein interactions\nIdentify hydrogen bonds at protein interfaces\nDetermine key residues involved in protein-protein recognition\nUnderstand the structural basis of protein binding specificity"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#setting-up-the-structure",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#setting-up-the-structure",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "2.1 Setting up the structure",
    "text": "2.1 Setting up the structure\nDownload the crystal structure:\n\nFile &gt; Load &gt; PDB file from Internet &gt; 1BRS\nYou can see three identical Barnase-Barstar complexes where we need only one\n\n\n\n\n\n\n\nTip\n\n\n\nIf you want to have less disruptive backround, you can go to View &gt; Color &gt; Background color and change it to white or black for better visualization.\n\n\nAnalyze the scene contents:\nIn the right-hand panel, you can see a single object named 1BRS. Click on it to expand. There are 12 molecules under 1BRS:\n\nMol A, B, C = Barnase (ribonuclease)\nMol D, E, F = Barstar (inhibitor)\nMol A, B, C, D, E, F (in red) = water molecules\n\n\n\n\n\n\n\nTip\n\n\n\nWorking with structure (with apple mouse)\n\nZoom in/Zoom out: Hold right click\nTurning the Structure: Hold left click"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#structure-cleaning",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#structure-cleaning",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "2.2 Structure cleaning",
    "text": "2.2 Structure cleaning\nRemove redundant molecules:\n\nRemove water molecules (highlighted in red) by right-clicking and choosing “Delete”\nRemove Mol B, C, E, F (right-click and choose “Delete”)\nNow you have only one Barnase (Mol A)-Barstar (Mol D) complex\n\n\n\n\n\n\n\nTip\n\n\n\nYou can change visualization by clicking on yes/no in the Vis column in right-hand panel on the screen. You can change the color of Mol A and Mol D by right click on them in right-hand panel.\nNavigate the mouse to the bottom of the screen and you can see a tab with residues for the structures, and you can select each residue. Also by right-click on the residue you can change the residue color.\n\n\nCenter the structure:\n\nRight-click on the object (1brs) from the right-hand panel and choose ‘Center’\n\nAdd missing hydrogen atoms:\n\nEdit &gt; Clean &gt; All"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#force-field-and-energy-minimization",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#force-field-and-energy-minimization",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "2.3 Force field and energy minimization",
    "text": "2.3 Force field and energy minimization\nSelect the force field:\n\nSimulation &gt; Force field &gt; AMBER 14 &gt; check the box next to ‘use PME…’ &gt; OK\n\nMinimize the energy:\n\nOptions &gt; Energy minimization\nAfter minimization, from the right-hand panel, right-click on SimCell and Delete it\n\nSave the prepared complex:\n\nFile &gt; Save as &gt; PDB file &gt; select 1BRS from both Sequence and Name panels &gt; OK &gt; give a name (1BRS_complex.pdb)\n\n\n\n\n\n\n\nTip\n\n\n\nFor better visualization, color Mol A (grey) and Mol D (magenta) by right-click in right-hand panel on the screen."
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#visualization-setup",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#visualization-setup",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "3.1 Visualization setup",
    "text": "3.1 Visualization setup\nOptimize visualization:\n\nView &gt; Hide atoms &gt; Aliphatic hydrogens"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#hydrogen-bond-analysis",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#hydrogen-bond-analysis",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "3.2 Hydrogen bond analysis",
    "text": "3.2 Hydrogen bond analysis\n\nVisualize protein-protein interactions:\n\nFor this step there are two options to visualize hydrogen bonds between Barnase (Mol A) and Barstar (Mol D):\nView&gt;Show interactions&gt;Hydrogen Bonds of&gt;Molecules\nOr\nOpen the Window&gt;Console&gt;Open Now (or press space bar on your keyboard) &gt; enter the command “ShowHBoAtom Mol A with distance&lt;2.6 from Mol D” Or “ShowHBoAtom Mol D with distance&lt;2.6 from Mol A”\nNow you can see the hydrogen bond between two proteins shown in yellow dashed lines.\n\n\n\n\n\n\nQ1 Examine which residues of Barstar (Mol D) form the most hydrogen bonds with Barnase (Mol A)?\n\n\n\n\nTake a closer look at the interface between the two proteins\nFocus on regions with multiple hydrogen bonds\nNote the types of residues involved in the interactions"
  },
  {
    "objectID": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#sequence-preparation-for-further-analysis",
    "href": "practicals/PRACTICALS-Structure_Prediction/PRACTICAL_PROTEIN_STRUCTURE_ANALYSIS.html#sequence-preparation-for-further-analysis",
    "title": "Protein Complex Structure Analysis with YASARA",
    "section": "3.3 Sequence preparation for further analysis",
    "text": "3.3 Sequence preparation for further analysis\nObtain sequences for downstream analysis:\n\nOpen your internet browser and go to www.rcsb.org\nSearch for 1BRS\nClick on ‘Download Files’ and choose ‘FASTA Sequence’\nOpen the downloaded FASTA file using a text editor (notepad on Windows)\nYou can see the sequences of both proteins that will be used in the next practical\nscp the FASTA file to the AF folder on Vera for the next practical"
  }
]